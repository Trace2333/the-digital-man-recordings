# Beam search与其实现

## 一、什么是beam search（集束搜索）

beam search不算一个机器学习算法之类的内容，而是一个序列最优计算算法。

即在一个序列生成任务中，对每一步的结果进行排序评估，找到topK个次优解并将其作为候选，在下一步的生成中进行选择，并依据此结果来依次生成预测。

## 二、beam search的具体操作

beam search中有几个必给的参数，即min_length,max_length,**num_beams**

 其中num_beams最为重要，它规定了每次保留的topK个次优解，理论上来说，num_beams在一定范围内越大越好，备选的序列生成结果也越多，但是最后它所耗费的时间也越多。

## ![beam1](https://s3.bmp.ovh/imgs/2022/08/18/8c91cfa6d3921d43.png)

如上网图可以部分说明它的工作过程。

1.在第一步的输出即通过[]得到A、C的时候，保留。

2.在A、C作为输出的基础上将其作为序列模型的输入，得到第二个时间步的输出，即下一轮的ABCDE

3.从下一步的输出中得到1个最优结果，保留。

4.循环操作得到最终序列

在实际使用的时候，每次只保留了两步，即某一个时间时刻的topK个最大概率输出和下一步的全部输出，从中选出1个待选。

**注意：每次的输出要以上一步的topK个输出分别进行生成得到。不同时间步的概率没有比较的意义。**

原理和深度搜索有一点类似。

## 三、代码实现

```Python

```

